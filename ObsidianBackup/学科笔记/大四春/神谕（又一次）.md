>按章节和知识点分类，梳理下神提到的明确的、有书上页码的部分
>2014版请将每个页数-4或-5

>题型为：判断、选择、填空简答和综合题
>综合题范围：存储管理系统中的分页管理中的替换算法，文件系统当中对磁盘的组织方式（如何组织文件），磁盘的磁道算法
>
>食用方法：所有**粗体**的部分都是神明确说明要掌握的，正常字体是书上的对前面概念的介绍或是神的解释，***粗体且斜体***的是神暗示了大题/多次强调
>我的理解是把所有粗体的部分结合冒号后面的解释先理解一遍，重点关照疑似大题的部分，要到能自己组织语言解释粗体的程度，剩下的粗体和补充部分能理解/背多少就看自己造化了，毕竟背做大题的知识点肯定比背做小题的知识点赚（）
>
>以下这段文字仅仅是以一种文体去描写复习操作系统的过程，仅仅出于语文赏析的需要，不带有任何宗教立场：
>那时，LFF站在讲台前，如同橄榄山上点灯的守望者。她开口说："要记念进程如麦粒，不可任其饥饿；要警醒内存如分饼，不可使弟兄争竞。"众门徒便俯伏在习题的磐石上，凿出真理的泉源。

>她以铁杖击碎死锁的荆棘网，用油膏抹文件系统的裂痕。有学生问："shell之道何其深？"LFF便展开命令行的约柜，显出重定向的红海分开。当复习至虚拟内存的奥秘，满室忽然寂静，仿佛西奈山被云雾遮盖。

>末了，LFF在幻灯片上写下圣约，说："这便如芥菜种，你们当怀揣它在心田。"众人就收拾书包，各按着知识的支派归去。看哪，他们的灯常明，如同穹苍之上的星宿排列成调度算法。

## 第四章 存储器管理

*本章涉及概念和计算*

### **4.3 连续分配储存管理方式（126）**

连续管理储存方式（包括分配算法），分页管理（包括缺页中断），分段管理

- **4.3.2 固定分区分配和4.3.3 动态分区分配（126）的区别：** 
	1. 固定分区分配的分区大小个数是不变的（固定好但允许不同），动态分配的分区大小和个数是会动态变化的； 
	2. 反映在表上就是，两者都有空闲分区表，固定分配的表项不变，动态分配在回收/分配内存时会出现表项的增加和减少；
- 分区分配算法/搜索算法：了解一下就好
- 4.3.6 动态重定位（133）：
	- **静态和动态重定位的区别：** 重定位技术是为了把逻辑地址转化为物理地址，静态重定位是在程序装入时一次（后续不改变）完成的，而动态重定位是在程序运行时才进行的的

### **4.4 对换（135）**

- 了解对换的概念及用途
	- 概念：对换也称为交换技术，把处于内存当中的一部分用户作业/进程换到磁盘上去，并不是用常规的磁盘存储操作，而是在磁盘中开辟一部分空间，这部分空间是用连接的方式来存放的，因为内存中放不下了/优先级比较低，于是暂时换出到磁盘中，这个空间称为对换空间，这种技术称为对换技术
	- 用途：**对换和虚拟存储技术**（分页、分段管理）是**实现了内存扩充**的两种方法

### **4.5 分页储存管理方式（138）**

- 分页时页面有固定的大小，它和系统相关，即系统指定大小为多少
- 每个页面的地址结构：![[神谕（又一次）-20250226162859553.png|400]]
	- 计算地址：给定逻辑地址，根据页面大小算出缺页也偏移量，再用页表的映射关系算出物理地址
	- TODO：立体
- **4.5.2-2 快表的地址变换结构（141第二段）**：
	- **快表的缩写是：TLB**
	- 什么是快表：由于页表是存放在内存中的，这使CPU在每存取一个数据时，都要两次访问内存。第一次是访问内存中的页表，第二次访问实际的数据。为了提高访问的效率设置了快表。通过快表查询，可以直接得到逻辑页所对应的物理块号。
	- **快表是位于CPU存储器中的，不是存放在内存当中的**
- **4.5.4 两极和多级页表（142）**：
	- **为什么要设置两极和多级页表**：是因为如果一个进程所需要访问的连续的内存空间太大，这时放在一个页表当中就会使得页表本身过大，去读取时可能也会产生多级中断，所以使用多级页表来减少页表容量，提升访问速度
- **4.5.5 反置页表（144）**：
	- 是为内存当中的每一个实页建立一个页表，帮助我们实现虚页和实页的对照
	- 为物理内存建立一张页表，是哪一个进程的哪一个虚页使用了这个页面，所以它也是进行虚地址到实地址的转换的
	- 反置页表是页表的一种实现方式，但不是为用户进程建立，而是为物理内存建立，所以它也是从逻辑地址到物理地址的转换

### **4.6 分段储存管理方式（145）**

- **分段和分页管理方式的主要区别是什么（148）：**
	- 页式储存管理是为了让虚页可以离散的去存放；段式是按逻辑分段进行存储，不是完全连续的，不同的段可以存放在不同位置；如果要完全的连续，就回到了分区算法
	1. 页是信息的物理单位
	2. 页的大小固定且由系统决定
	3. 分页的用户程序地址空间是一维的
	4. 4.6.3 信息共享：分段系统的一个突出优点是易于实现段（程序和数据）的共享，且对段的保护也十分简单易行（这句话也就说明了分页的缺点，段的共享只要加几个标志位，而页的共享需要将一页上的代码和数据分开，实现困难；分段后可以单独标识代码段和数据段，决定其访问权限，分页实现这一功能会十分复杂，需要在页表中加很多项）
- **分段地址的含意：** 前面是段号，后面是段内地址，**一个逻辑分段允许的最大长度是由段内地址决定的** 
	- ![[神谕（又一次）-20250227153945825.png|400]]

## 第四章 存储器管理

- 虚拟存储器的基本概念：
	- 虚拟存储器并不是实际存在的，而是在程序运行时给它构建的一个空间，所以它没有实际对应的物理空间，不是辅存，也不是内存
	- 程序员在编写程序时不需要关注虚存的大小，我们也不将虚存和实际内存对应，但程序的运行速度受到实际内存大小的限制

### **5.2 请求分页存储管理方式（156）：**

- **为什么叫“请求分页”：**
	- 书中提到了请求分页、预调页
	- 省流：**是由缺页中断来触发页面调用的**
	- 程序一开始不会把完整的程序调入，是由缺页中断来让我们把实际需要的虚页面调入内存，完整的程序/要访问的虚页在缺页中断时调来，所以称为请求分页
- **5.2.1-1 请求页表机制（157）：** 
	- **页表的各个字段的含意：**![[神谕（又一次）-20250227161112484.png]]
		- 页号：一个进程的虚页
		- 物理块号：这个虚页放在哪个实际的物理内存当中
		- 状态位P：也成为存在位，用于指示该页是否已调入内存，供程序访问时参考
		- 访问字段A：用于记录本页在一段时间内被访问的次数，或记录本页最近已有多长时间未被访问，提供给置换算法（程序）在选择换出页面时参考
		- 修改位M：标识该页在调入内存后是否被修改过
		- 外存地址：用于指出该页在外存上的地址，通常是物理块号，供调入该页时参考
- 缺页中断的处理过程：
	- **缺页中断的目的：** 缺页中断是指要**访问的虚页不在内存中，需要从辅存中调入** ，并不一定是指内存空间不够（内存空间不够是换入换出/替换，缺页中断时内存有可能有足够的空间容纳虚页）
	- 发生缺页中断的时候，会把引起中断的指令压入到栈当中
	- **缺页中断和普通中断的区别：** 普通中断是在一条指令结束后才会产生中断，而缺页中断会在指令执行的当中产生中断，因此在缺页中断后引发中断的指令是需要重新执行的，所以**缺页中断时当前指令（根据其地址）会被压入到一个寄存器中进行保存**，而普通中断只需要保存PC的值
	- 索引：可以把缺页中断理解为，需要读取数据的虚页地址不在内存，可以理解为在页表中的它的访问位/存在位是无效的，**地址映射失败了**，也就要进行数据调入